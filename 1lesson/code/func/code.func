;; firstcontract


;; recv_internal - Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ Ğº ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñƒ Ğ¸Ğ· TON
;; -> ğŸ”¹accessing a contract from TON
;; -> ğŸ”¹requesting a contract from TON
;; impure - Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¼Ğ°Ñ€Ñ‚-ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ° 
;; -> ğŸ”¹function changes smart contract datağŸ”¹function changes smart contract data
;; slice - Ğ½ĞµĞºĞ¸Ğ¹ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ° ÑÑ‡ĞµĞ¹ĞºÑƒ Ğ¸Ğ· ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
;; -> ğŸ”¹some pointer to a cell from which you can read data
() recv_internal(slice in_msg_body) impure {
  ;;slice_bits() Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ±Ğ¸Ñ‚Ğ¾Ğ² Ğ² slice
  ;; -> ğŸ”¹slice_bits() returns the number of bits in the slice
  ;;throw_if Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
  ;; -> ğŸ”¹exception
  throw_if(35,in_msg_body.slice_bits() < 32);
  ;; Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ¸Ğ· ÑĞ»Ğ°Ğ¹ÑĞ° uint Ğ±Ğ¸Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ 32
  ;; -> ğŸ”¹load uint from slice with 32 bits
  int n = in_msg_body~load_uint(32);

  ;;get_data Ğ±ĞµÑ€ĞµÑ‚ ÑÑ‡ĞµĞ¹ĞºÑƒ Ğ¸Ğ· storage c4 Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°
  ;; -> ğŸ”¹takes a cell from the storage c4 register 
  ;;begin_parse ÑÑ‡ĞµĞ¹ĞºÑƒ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµÑ‚ Ğ² slice 
  ;; -> ğŸ”¹cell is converted to slice
  slice ds = get_data().begin_parse();
  ;; Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ¸Ğ· ÑĞ»Ğ°Ğ¹ÑĞ° uint Ğ±Ğ¸Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ 64
  ;; -> ğŸ”¹load uint from slice with 64 bits
  int total = ds~load_uint(64);

  total += n;
		
  ;; ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² ÑÑ‡ĞµĞ¹ĞºÑƒ
  ;; -> ğŸ”¹sets the value in the cell
  ;; begin_cell ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ builder end_cell Ğ¿Ñ€ĞµĞ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ builder Ğ² end_cell
  ;; -> ğŸ”¹begin_cell creates a builder end_cell turns the builder into an end_cell
  ;;
  set_data(begin_cell().store_uint(total, 64).end_cell());
}

;; testable
int get_total() method_id {
  slice ds = get_data().begin_parse();
  int total = ds~load_uint(64);
  return total;
}
